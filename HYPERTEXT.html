<!-- Mini Hypertext Story HTML Start -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Lost Compass - Hypertext Story</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  :root{
    --bg:#8d8f8e;
    --card:#80b9a3;
    --accent-deep:#0f3b2e; /* deep forest */
    --accent-mid:#2b6b4a;  /* moss */
    --accent-soft:#89b393; /* leaf */
    --mystery:#2a2340;     /* twilight purple */
    --muted:#111111;
  }
  html,body{height:100%;margin:0}
  body { font-family: 'Courier New', Courier, monospace; background:var(--bg); color:var(--accent-deep); line-height:1.6; padding:28px; }
  .container { max-width:980px; margin:18px auto; background:linear-gradient(180deg, rgba(194, 152, 124, 0.98), rgba(63, 159, 223, 0.98)); padding:28px; border-radius:12px; box-shadow:0 6px 30px rgba(18,30,24,0.12); border-left:6px solid var(--accent-mid);} 
  h1 { margin-top:0; color:var(--accent-deep); letter-spacing:1px; }
  h2 { color:var(--mystery); margin-bottom:6px }
  p { margin:10px 0 }
  a.choice { display:inline-block; margin:10px 8px 10px 0; padding:8px 12px; background:linear-gradient(180deg,var(--accent-soft), rgba(255,255,255,0.6)); color:var(--accent-deep); border-radius:8px; text-decoration:none; border:1px solid rgba(0,0,0,0.04); box-shadow:0 2px 0 rgba(0,0,0,0.04); }
  a.choice:hover{ transform:translateY(-2px); box-shadow:0 6px 18px rgba(12,34,18,0.06)}
  .meta { color:var(--muted); font-size:0.9rem }
  .row{display:flex;gap:18px;align-items:flex-start}
  .col{flex:1}
  .sidebar{width:220px; background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.35)); padding:12px; border-radius:10px}
  /* SVG icon styling */
  .icons svg{width:42px;height:42px;margin-right:8px;vertical-align:middle}
  .note{font-size:0.95rem;color:var(--muted)}
  pre{background:#0f1720;color:#e3e9e5;padding:12px;border-radius:8px;overflow:auto}
  /* story map */
  .map { margin-top:14px; background:linear-gradient(180deg, rgba(255,255,255,0.0), rgba(255,255,255,0.4)); padding:12px; border-radius:8px }
  footer{margin-top:20px;font-size:0.9rem;color:var(--muted)}
  /* small responsive tweaks */
  @media (max-width:800px){ .row{flex-direction:column} .sidebar{width:100%} }
  #ambienceBtn:hover{transform:scale(1.08);box-shadow:0 6px 18px rgba(0,0,0,0.25);} 
  /* fade-in image animation */
  .fade-img{opacity:0;transform:translateY(10px);transition:opacity 1.2s ease-out,transform 1.2s ease-out}
  .fade-img.visible{opacity:1;transform:translateY(0)}
</style>
</head>
<body>
<header class="title-block">
  <h1>The Compass in the Attic</h1>
  <p class="author">By Crismae V. Montes</p>
  <p class="class">Technical Writing ‚Äì San Mateo Municipal College</p>
  <hr/>
</header>

<div class="container">
  <div class="row">
    <div class="col">
      <h1>The Lost Compass</h1>
      <p class="meta"><em>Low Fantasy Mystery</em> &nbsp;‚Ä¢&nbsp; A mini hypertext story ‚Äî combine narrative choices with visuals. Click choices to navigate.</p>

      <!-- icon set -->
<div class="icons" aria-hidden="true"> 
  <!-- Leaf -->
  <a href="#path1" title="Go to Path 1 ‚Äì Follow the Compass">
    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="leaf icon">
      <defs>
        <linearGradient id="leafGrad" x1="32" y1="0" x2="32" y2="64" gradientUnits="userSpaceOnUse">
          <stop offset="0%" stop-color="#4CAF50"/>
          <stop offset="100%" stop-color="#2E7D32"/>
        </linearGradient>
      </defs>
      <path d="M32 2C20 10 12 28 30 60C52 32 36 12 32 2Z" fill="url(#leafGrad)" stroke="var(--accent-mid)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </a>

  <!-- Compass / Back to Start -->
  <a href="#intro" title="Back to Start">
    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="compass icon">
      <circle cx="32" cy="32" r="14" stroke="var(--accent-deep)" stroke-width="3" fill="none"/>
      <path d="M32 18 L38 32 L26 38 L32 18 Z" fill="var(--accent-mid)"/>
      <circle cx="32" cy="32" r="2" fill="var(--accent-deep)"/>
    </svg>
  </a>

  <!-- Forest Door -->
  <a href="#path3" title="Go to the Forest Door">
    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="door icon">
      <defs>
        <linearGradient id="doorGrad" x1="16" y1="12" x2="48" y2="52" gradientUnits="userSpaceOnUse">
          <stop offset="0%" stop-color="#8D6E63"/>
          <stop offset="100%" stop-color="#5D4037"/>
        </linearGradient>
      </defs>
      <rect x="16" y="12" width="32" height="40" rx="4" fill="url(#doorGrad)" stroke="var(--mystery)" stroke-width="2"/>
      <circle cx="44" cy="36" r="2" fill="var(--accent-mid)"/>
    </svg>
  </a>
</div>


      <hr />

      <section id="intro">
        <img class="fade-img" src="https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1200&q=60" alt="Overgrown attic window with soft forest light" style="width: 50%;border-radius:12px;margin-bottom:16px;"/>
        <p>You find an old brass compass in your grandmother's attic, wrapped in oilcloth. The needle trembles and then spins as if answering a distant call. Outside, the trees press close like an audience waiting for a scene to begin.</p>
        <a class="choice" href="#path1">Follow the compass ‚á¢</a>
        <a class="choice" href="#path2">Ignore it and keep cleaning ‚á¢</a>
      </section>

      <section id="path1">
        <img class="fade-img" src="https://images.unsplash.com/photo-1504215680853-026ed2a45def?auto=format&fit=crop&w=1200&q=60" alt="Hands holding an old brass compass in the forest" style="width:30%;border-radius:10px;margin-bottom:5%"/>
        <h2>üß≠ Path 1 ‚Äî Follow the Compass</h2>
        <p>The compass pulls you toward the low ridge behind your grandmother's house. The air smells of wet stone and pine. A faint, uncertain hum threads through the leaves. You find a patch of ground with tiny symbols scratched into the soil‚Äîspirals and arrows that glow faintly when the compass is near.</p>
        <p class="note">Visual cue: the compass icon pulses when it's an active clue ‚Äî we represent that here with the glowing symbols.</p>

        <a class="choice" href="#path3">Enter the forest ‚á¢</a>
        <a class="choice" href="#path4">Turn back ‚á¢</a>
      </section>

      <section id="path2">
        <h2>üì¶ Path 2 ‚Äî Ignore It</h2>
        <p>You place the compass on the attic shelf and continue sorting boxes. Later that night, a metallic tapping echoes from the rafters. The house feels different‚Äîlike a paused breath. Do you investigate or hide?</p>
        <a class="choice" href="#path5">Investigate the sound ‚á¢</a>
        <a class="choice" href="#path6">Hide under the blanket ‚á¢</a>
      </section>

      <section id="path3">
        <h2>üå≤ Path 3 ‚Äî Into the Forest</h2>
        <p>Inside the forest, moss carpets fallen trunks and the light leans green. The hum becomes a melody‚Äîlow, harmonized, as if the trees themselves are singing. You come upon a door standing free between two oaks: a carved oak slab with iron hinges, humming at the frequency of the compass. The needle freezes and points straight at the latch.</p>
        <p><strong>Choices:</strong></p>
        <a class="choice" href="#opening">Open the door ‚á¢</a>
        <a class="choice" href="#followsound">Follow the humming deeper ‚á¢</a>
        <a class="choice" href="#inspectmarks">Inspect the ground markings ‚á¢</a>
      </section>

      <!-- Expanded scene: opening the door (user asked to expand Path 1) -->
      <section id="opening">
        <h2>‚≠ê Expanded Scene ‚Äî Opening the Door</h2>
        <p>You place a hand on the iron ring. The forest exhales. The latch is warm despite the cool air. When you draw the door open, the edges leak a pale, silver mist that smells faintly of rain and old pages.</p>
        <p>The space beyond is not a room but a hollow of air‚Äîan interior made of light. Islands drift in an indigo sky, tethered by vines of starlight. Below, a river like quicksilver winds through ancient letters and maps that float like autumn leaves. The compass vibrates against your palm, aligning with a star above one of the islands. A small wooden walkway invites you across; each step hums like a tuning fork and leaves a faint footprint of green light.</p>
        <p>The longer you stand, the more you realize this place remembers‚Äîobjects here pulse with memory: a child's carved boat that smells of salt, a broken watch that ticks but shows the wrong hours, a pair of spectacles that let you read the thoughts written on the river's surface. Somewhere on a distant island a bell rings in a code you almost recognize‚Äîyour grandmother's laugh, or perhaps a phrase she whispered when she thought no one listened.</p>
        <p class="note">This expanded scene leans into sensory detail and slow discovery ‚Äî ideal for a longer branch.</p>

        <a class="choice" href="#crosswalk">Cross the wooden walkway ‚á¢</a>
        <a class="choice" href="#turnback-duringopening">Step back (wait and watch) ‚á¢</a>
      </section>

      <section id="crosswalk">
        <h2>ü™µ Crosswalk ‚Äî The First Island</h2>
        <p>You step onto the walkway. Each board sings a note that fits into the chorus. At the island you meet a small, sap-stained cottage made of turned roots. On its sill rests a tin box engraved with your grandmother's initials.</p>
        <p>Inside the tin is a letter, folded many times. The handwriting is hers: "If you are holding this, then the compass found someone who remembers how to listen." The letter tells of a promise to guard a doorway between worlds and a debt left unpaid: someone needs help finding their way home.</p>
        <p>Choices ripple outward: help the stranger, take the compass home, or learn to speak the river's language.</p>
        <a class="choice" href="#helpstranger">Help the stranger ‚á¢</a>
        <a class="choice" href="https://cdn.britannica.com/85/78185-004-AE7965BC/compass-chart.jpg?s=1500x700&q=85">Take the compass home ‚á¢</a>
        <a class="choice" href="#learnriver">Learn the river's language ‚á¢</a>
      </section>

      <section id="turnback-duringopening">
        <h2>üçÉ Turn Back ‚Äî Watch from the Threshold</h2>
        <p>You step back and close the door gently. The silver mist sighs away. The forest resumes its ordinary silence as if nothing had been disturbed. Some doors, you decide, are invitations rather than obligations.</p>
        <p><strong>THE END (Quiet closing)</strong></p>
      </section>

      <section id="followsound">
        <h2>üîä Follow the Humming</h2>
        <p>You ignore the door and follow the humming deeper into the trees. The sound grows into a chorus of small bells and wind instruments, and you discover a clearing of stones arranged like a clock face. Each stone rings with a different pitch when the compass passes above it. When all stones chime the same note the ground reveals a spiral stair dropping into roots.</p>
        <p class="note">This path leads to a puzzle mechanic‚Äîsound and pattern recognition.</p>
        <a class="choice" href="#roots">Descend the spiral stairs ‚á¢</a>
      </section>

      <section id="inspectmarks">
        <h2>‚úçÔ∏è Inspect the Ground Markings</h2>
        <p>You kneel and trace one of the spirals with your finger. The soil is cool and hums beneath your skin. Beneath the surface, a faint outline of a map shows‚Äîroutes across the world to pockets of similar doors. One route leads to a place you know by name: a seaside cove your grandmother once painted.</p>
        <p>Choice: mark the map, memorize it, or follow the route now.</p>
        <a class="choice" href="https://cdn.prod.website-files.com/5efcb2de6010ca2c18f0cf59/63dcd51436664330c88a392e_geographical-map.jpg">Mark the map ‚á¢</a>
        <a class="choice" href="#memorize">Memorize only ‚á¢</a>
        <a class="choice" href="#followroute">Follow the route now ‚á¢</a>
      </section>

      <!-- other original paths (shortened for space) -->
      <section id="path4">
        <h2>üè† Path 4 ‚Äî Turn Back</h2>
        <p>You rush home with the compass clutched. Later, the compass projects a map in a wash of green light‚Äîleading to a hidden tree marked with your grandmother's initials. The mystery waits.
        <strong>THE END (Mystery Unsolved)</strong></p>
      </section>

      <section id="path5">
        <h2>üîß Path 5 ‚Äî Investigate (Attic)</h2>
        <p>The compass floats and hums; a voice‚Äîsoft and familiar‚Äîsays: "Time to finish what was started." The floorboards creak like a question. You can reach for the compass or close the attic door and sleep.</p>
        <a class="choice" href="#grabcompass">Grab the compass ‚á¢</a>
      </section>

      <section id="path6">
        <h2>üò¥ Path 6 ‚Äî Hide</h2>
        <p>You hide and the tapping stops. In dreams, the compass calls. You wake unsure whether the attic sounded a message or a memory.
        <strong>THE END (To Be Continued?)</strong></p>
      </section>

      <footer>
        <p class="note">Tips: Use the map at right to see your choices. This HTML is printable and works offline. The "Play Ambience" button synthesizes gentle forest sounds in your browser‚Äîno external files needed.</p>
      </footer>
    </div>

    <aside class="sidebar">
      <div>
        <h3 style="margin-top:0">Story Map</h3>
        <div class="map">
          <!-- simple SVG story map -->
          <svg viewBox="0 0 320 220" width="100%" height="160" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="story map">
            <defs>
              <linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="var(--accent-soft)"/><stop offset="1" stop-color="var(--accent-mid)"/></linearGradient>
            </defs>
            <circle cx="50" cy="30" r="20" fill="url(#g1)" stroke="var(--accent-deep)"/>
            <text x="50" y="35" font-size="10" text-anchor="middle" fill="#07251a">Start</text>

            <circle cx="150" cy="30" r="20" fill="#fff" stroke="var(--mystery)"/>
            <text x="150" y="35" font-size="10" text-anchor="middle" fill="var(--mystery)">Forest</text>

            <circle cx="250" cy="30" r="20" fill="#fff" stroke="var(--accent-mid)"/>
            <text x="250" y="35" font-size="10" text-anchor="middle" fill="var(--accent-mid)">Attic</text>

            <line x1="66" y1="30" x2="132" y2="30" stroke="rgba(10,40,30,0.12)" stroke-width="2"/>
            <line x1="168" y1="30" x2="236" y2="30" stroke="rgba(10,40,30,0.12)" stroke-width="2"/>

            <circle cx="150" cy="100" r="20" fill="#fff" stroke="var(--accent-mid)"/>
            <text x="150" y="105" font-size="10" text-anchor="middle" fill="var(--accent-mid)">Door</text>

            <line x1="150" y1="48" x2="150" y2="82" stroke="rgba(10,40,30,0.12)" stroke-width="2"/>

            <circle cx="100" cy="170" r="20" fill="#fff" stroke="var(--mystery)"/>
            <text x="100" y="175" font-size="10" text-anchor="middle" fill="var(--mystery)">Island</text>

            <line x1="150" y1="118" x2="110" y2="158" stroke="rgba(10,40,30,0.08)"/>
          </svg>
        </div>

        <div style="margin-top:12px">
          <button id="ambienceBtn" aria-label="Toggle ambience sound" style="cursor:pointer;width:42px;height:42px;border-radius:50%;border:none;display:flex;align-items:center;justify-content:center;background:var(--accent-soft);position:fixed;bottom:18px;right:18px;box-shadow:0 4px 12px rgba(0,0,0,0.18);transition:all 0.3s;">
  <svg id="soundIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="var(--accent-deep)">
    <path d="M3 10v4h4l5 5V5L7 10H3z"/>
  </svg>
</button>
        </div>

        <div style="margin-top:12px">
          <h4 style="margin:6px 0">Legend</h4>
          <p class="note">Green nodes = exploration. Purple = mystery choices. White = neutral checkpoints.</p>
        </div>
      </div>
    </aside>
  </div>
</div>

<script>
// --- Sound Toggle Icon Logic ---
const soundIcon = document.getElementById('soundIcon');
let soundOn = false;

function updateSoundIcon(){
  if(soundOn){
    soundIcon.innerHTML = '<path d="M3 10v4h4l5 5V5L7 10H3z"/><path d="M16 8.82v6.36c1.18-.64 2-1.86 2-3.18s-.82-2.54-2-3.18z"/>';
  } else {
    soundIcon.innerHTML = '<path d="M3 10v4h4l5 5V5L7 10H3z"/>';
  }
}

// Simple ambient sound synthesizer (gentle forest-like hum + chime) ‚Äî no external files.
let ctx, master;
function initAudio(){
  if(ctx) return;
  ctx = new (window.AudioContext || window.webkitAudioContext)();
  master = ctx.createGain(); master.gain.value = 0.0; master.connect(ctx.destination);

  // gentle filtered noise for wind/leaf rustle
  const bufferSize = 2 * ctx.sampleRate;
  const noiseBuffer = ctx.createBuffer(1, bufferSize, ctx.sampleRate);
  const data = noiseBuffer.getChannelData(0);
  for(let i=0;i<bufferSize;i++) data[i] = (Math.random()*2-1) * 0.25;
  const noise = ctx.createBufferSource(); noise.buffer = noiseBuffer; noise.loop = true;
  const noiseFilter = ctx.createBiquadFilter(); noiseFilter.type = 'lowpass'; noiseFilter.frequency.value = 1200;
  const noiseGain = ctx.createGain(); noiseGain.gain.value = 0.6;
  noise.connect(noiseFilter); noiseFilter.connect(noiseGain); noiseGain.connect(master);
  noise.start();

  // slow harmonic drone
  const osc = ctx.createOscillator(); osc.type='sine'; osc.frequency.value = 110; // low A
  const oscGain = ctx.createGain(); oscGain.gain.value = 0.0; // start silent
  osc.connect(oscGain); oscGain.connect(master);
  osc.start();

  // subtle bell chime every ~12s
  function chime(time){
    const now = ctx.currentTime + time;
    const o = ctx.createOscillator(); o.type='sine'; o.frequency.value = 660;
    const g = ctx.createGain(); g.gain.value = 0.0;
    o.connect(g); g.connect(master);
    g.gain.setValueAtTime(0.0, now);
    g.gain.linearRampToValueAtTime(0.08, now+0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, now+2.4);
    o.start(now); o.stop(now+2.6);
  }

  // periodically trigger chime
  let chimeInterval = setInterval(()=>{ chime(0); }, 12000);

  // expose control
  return {noiseGain, oscGain, chimeInterval};
}

let controls=null;
document.getElementById('ambienceBtn').addEventListener('click', async function(){
  if(!ctx) controls = initAudio();
  // resume audioContext if suspended
  if(ctx.state === 'suspended') await ctx.resume();
  // toggle fade in/out
  if(master.gain.value < 0.001){
    master.gain.linearRampToValueAtTime(0.6, ctx.currentTime + 1.2);
    // bring up the drone gently
    controls && controls.oscGain && controls.oscGain.gain && controls.oscGain.gain.setValueAtTime(0.0001, ctx.currentTime);
    if(controls && controls.oscGain) controls.oscGain.gain.linearRampToValueAtTime(0.08, ctx.currentTime + 2);
    this.textContent = 'Pause';
  } else {
    master.gain.linearRampToValueAtTime(0.0, ctx.currentTime + 1.2);
    this.textContent = 'Play';
  }
});

// Ensure deep linking works (navigating to anchor updates scroll)
if(window.location.hash){
  const id = window.location.hash.substring(1);
  const el = document.getElementById(id);
  if(el) el.scrollIntoView({behavior:'smooth'});
}
// --- Ambient Audio System ---
let ambienceAudio;
let isFading = false;
const ambienceBtn = document.getElementById('ambienceBtn');
const savedPref = localStorage.getItem('ambienceOn');

function initAmbience(){
  if(!ambienceAudio){
    ambienceAudio = new Audio('assets/audio/forest-night.mp3');
    ambienceAudio.loop = true;
    ambienceAudio.volume = 0;
  }
  if(savedPref === 'true'){
    soundOn = true;
    updateSoundIcon();
    fadeIn();
  }
}

function fadeIn(){
  if(isFading) return;
  isFading = true;
  ambienceAudio.play();
  let vol = ambienceAudio.volume;
  const fade = setInterval(()=>{
    if(vol < 0.5){ vol += 0.02; ambienceAudio.volume = vol; }
    else{ clearInterval(fade); isFading = false; }
  },80);
}

function fadeOut(){
  if(isFading) return;
  isFading = true;
  let vol = ambienceAudio.volume;
  const fade = setInterval(()=>{
    if(vol > 0.01){ vol -= 0.02; ambienceAudio.volume = vol; }
    else{ clearInterval(fade); ambienceAudio.pause(); isFading = false; }
  },80);
}

ambienceBtn.addEventListener('click',()=>{
  if(!ambienceAudio) initAmbience();
  soundOn = !soundOn;
  localStorage.setItem('ambienceOn',soundOn);
  updateSoundIcon();
  if(soundOn) fadeIn(); else fadeOut();
});

window.addEventListener('touchstart',()=>{
  if(ambienceAudio && ambienceAudio.paused && soundOn){ ambienceAudio.play(); }
},{once:true});
// --- End Ambient Audio System ---
// fade-in intersection observer
const observer=new IntersectionObserver(entries=>{entries.forEach(e=>{if(e.isIntersecting)e.target.classList.add('visible')})},{threshold:0.2});
document.querySelectorAll('.fade-img').forEach(el=>observer.observe(el));
</script>

<footer class="copyright">
  <p>¬© 2025 Crismae V. Montes. This project is created for educational purposes.
  All included visuals/icons are public domain or licensed for free educational use.</p>
</footer>
</body>
</html>
<!-- Mini Hypertext Story HTML End -->
